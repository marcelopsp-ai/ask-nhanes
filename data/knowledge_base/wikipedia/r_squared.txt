Source: https://en.wikipedia.org/wiki/Coefficient_of_determination
Topic: Coefficient of determination

In statistics, the coefficient of determination, denoted R or r and pronounced "R squared", is the proportion of the variation in the dependent variable that is predictable from the independent variable(s).
It is a statistic used in the context of statistical models whose main purpose is either the prediction of future outcomes or the testing of hypotheses, on the basis of other related information. It provides a measure of how well observed outcomes are replicated by the model, based on the proportion of total variation of outcomes explained by the model.

There are several definitions of R that are only sometimes equivalent. In simple linear regression (which includes an intercept), r is simply the square of the sample correlation coefficient (r), between the observed outcomes and the observed predictor values. If additional regressors are included, R is the square of the coefficient of multiple correlation. In both such cases, the coefficient of determination normally ranges from 0 to 1.

There are cases where R can yield negative values. This can arise when the predictions that are being compared to the corresponding outcomes have not been derived from a model-fitting procedure using those data. Even if a model-fitting procedure has been used, R may still be negative, for example when linear regression is conducted without including an intercept, or when a non-linear function is used to fit the data. In cases where negative values arise, the mean of the data provides a better fit to the outcomes than do the fitted function values, according to this particular criterion.

The coefficient of determination can be more intuitively informative than MAE, MAPE, MSE, and RMSE in regression analysis evaluation, as the former can be expressed as a percentage, whereas the latter measures have arbitrary ranges. It also proved more robust for poor fits compared to SMAPE on certain test datasets.

When evaluating the goodness-of-fit of simulated (Ypred) versus measured (Yobs) values, it is not appropriate to base this on the R of the linear regression (i.e., Yobs= m·Ypred + b). The R quantifies the degree of any linear correlation between Yobs and Ypred, while for the goodness-of-fit evaluation only one specific linear correlation should be taken into consideration: Yobs = 1·Ypred + 0 (i.e., the 1:1 line).

A data set has n values marked y1, ..., yn (collectively known as yi or as a vector y = [y1, ..., yn]), each associated with a fitted (or modeled, or predicted) value f1, ..., fn (known as fi, or sometimes ŷi, as a vector f).

Define the residuals as ei = yi − fi (forming a vector e).

If 






y
¯





{\displaystyle {\bar {y}}}

 is the mean of the observed data:







y
¯



=


1
n



∑

i
=
1


n



y

i




{\displaystyle {\bar {y}}={\frac {1}{n}}\sum _{i=1}^{n}y_{i}}


then the variability of the data set can be measured with two sums of squares formulas:

The most general definition of the coefficient of determination is





R

2


=
1
−



S

S


r
e
s





S

S


t
o
t








{\displaystyle R^{2}=1-{SS_{\rm {res}} \over SS_{\rm {tot}}}}

In the best case, the modeled values exactly match the observed values, which results in 



S

S

res


=
0


{\displaystyle SS_{\text{res}}=0}

 and R = 1. A baseline model, which always predicts y, will have R = 0.

In a general form, R can be seen to be related to the fraction of variance unexplained (FVU), since the second term compares the unexplained variance (variance of the model's errors) with the total variance (of the data):





R

2


=
1
−

FVU



{\displaystyle R^{2}=1-{\text{FVU}}}

A larger value of R implies a more successful regression model.
Suppose R = 0.49. This implies that 49% of the variability of the dependent variable in the data set has been accounted for, and the remaining 51% of the variability is still unaccounted for. 
For regression models, the regression sum of squares, also called the explained sum of squares, is defined as

In some cases, as in simple linear regression, the total sum of squares equals the sum of the two other sums of squares defined above:

See Partitioning in the general OLS model for a derivation of this result for one case where the relation holds. When this relation does hold, the above definition of R is equivalent to

where n is the number of observations (cases) on the variables.

In this form R is expressed as the ratio of the explained variance (variance of the model's predictions, which is SSreg / n) to the total variance (sample variance of the dependent variable, which is SStot / n).

This partition of the sum of squares holds for instance when the model values ƒi have been obtained by linear regression. A milder sufficient condition reads as follows: The model has the form

where the qi are arbitrary values that may or may not depend on i or on other free parameters (the common choice qi = xi is just one special case), and the coefficient estimates 






α
^





{\displaystyle {\widehat {\alpha }}}

 and 






β
^





{\displaystyle {\widehat {\beta }}}

 are obtained by minimizing the residual sum of squares.

This set of conditions is an important one and it has a number of implications for the properties of the fitted residuals and the modelled values. In particular, under these conditions:

In linear least squares multiple regression (with fitted intercept and slope), R equals 




ρ

2


(
y
,
f
)


{\displaystyle \rho ^{2}(y,f)}

 the square of the Pearson correlation coefficient between the observed 



y


{\displaystyle y}

 and modeled (predicted) 



f


{\displaystyle f}

 data values of the dependent variable.

In a linear least squares regression with a single explanator (with fitted intercept and slope), this is also equal to  




ρ

2


(
y
,
x
)


{\displaystyle \rho ^{2}(y,x)}

 the squared Pearson correlation coefficient between the dependent variable 



y


{\displaystyle y}

 and explanatory variable 



x


{\displaystyle x}

.

It should not be confused with the correlation coefficient between two explanatory variables, defined as

where the covariance between two coefficient estimates, as well as their standard deviations, are obtained from the covariance matrix of the coefficient estimates, 



(

X

T


X

)

−
1




{\displaystyle (X^{T}X)^{-1}}

.

Under more general modeling conditions, where the predicted values might be generated from a model different from linear least squares regression, an R value can be calculated as the square of the correlation coefficient between the original 



y


{\displaystyle y}

 and modeled 



f


{\displaystyle f}

 data values. In this case, the value is not directly a measure of how good the modeled values are, but rather a measure of how good a predictor might be constructed from the modeled values (by creating a revised predictor of the form α + βƒi). According to Everitt, this usage is specifically the definition of the term "coefficient of determination": the square of the correlation between two (general) variables.

R is a measure of the goodness of fit of a model. In regression, the R coefficient of determination is a statistical measure of how well the regression predictions approximate the real data points. An R of 1 indicates that the regression predictions perfectly fit the data.

Values of R outside the range 0 to 1 occur when the model fits the data worse than the worst possible least-squares predictor (equivalent to a horizontal hyperplane at a height equal to the mean of the observed data). This occurs when a wrong model was chosen, or nonsensical constraints were applied by mistake. If equation 1 of Kvålseth is used (this is the equation used most often), R can be less than zero. If equation 2 of Kvålseth is used, R can be greater than one.

In all instances where R is used, the predictors are calculated by ordinary least-squares regression: that is, by minimizing SSres. In this case, R increases as the number of variables in the model is increased (R is monotone increasing with the number of variables included—it will never decrease). This illustrates a drawback to one possible use of R, where one might keep adding variables (kitchen sink regression) to increase the R value. For example, if one is trying to predict the sales of a model of car from the car's gas mileage, price, and engine power, one can include probably irrelevant factors such as the first letter of the model's name or the height of the lead engineer designing the car because the R will never decrease as variables are added and will likely experience an increase due to chance alone.

This leads to the alternative approach of looking at the adjusted R. The explanation of this statistic is almost the same as R but it penalizes the statistic as extra variables are included in the model. For cases other than fitting by ordinary least squares, the R statistic can be calculated as above and may still be a useful measure. If fitting is by weighted least squares or generalized least squares, alternative versions of R can be calculated appropriate to those statistical frameworks, while the "raw" R may still be useful if it is more easily interpreted. Values for R can be calculated for any type of predictive model, which need not have a statistical basis.

Consider a linear model with more than a single explanatory variable, of the form

where, for the ith case, 





Y

i





{\displaystyle {Y_{i}}}

 is the response variable, 




X

i
,
1


,
…
,

X

i
,
p




{\displaystyle X_{i,1},\dots ,X_{i,p}}

 are p regressors, and 




ε

i




{\displaystyle \varepsilon _{i}}

 is a mean zero error term. The quantities 




β

0


,
…
,

β

p




{\displaystyle \beta _{0},\dots ,\beta _{p}}

 are unknown coefficients, whose values are estimated by least squares. The coefficient of determination R is a measure of the global fit of the model. Specifically, R is an element of [0, 1] and represents the proportion of variability in Yi that may be attributed to some linear combination of the regressors (explanatory variables) in X.

R is often interpreted as the proportion of response variation "explained" by the regressors in the model. Thus, R = 1 indicates that the fitted model explains all variability in 



y


{\displaystyle y}

, while R = 0 indicates no 'linear' relationship (for straight line regression, this means that the straight line model is a constant line (slope = 0, intercept = 






y
¯





{\displaystyle {\bar {y}}}

) between the response variable and regressors). An interior value such as R = 0.7 may be interpreted as follows: "Seventy percent of the variance in the response variable can be explained by the explanatory variables. The remaining thirty percent can be attributed to unknown, lurking variables or inherent variability."

A caution that applies to R, as to other statistical descriptions of correlation and association is that "correlation does not imply causation". In other words, while correlations may sometimes provide valuable clues in uncovering causal relationships among variables, a non-zero estimated correlation between two variables is not, on its own, evidence that changing the value of one variable would result in changes in the values of other variables. For example, the practice of carrying matches (or a lighter) is correlated with incidence of lung cancer, but carrying matches does not cause cancer (in the standard sense of "cause").

In case of a single regressor, fitted by least squares, R is the square of the Pearson product-moment correlation coefficient relating the regressor and the response variable. More generally, R is the square of the correlation between the constructed predictor and the response variable. With more than one regressor, the R can be referred to as the coefficient of multiple determination.

In least squares regression using typical data, R is at least weakly increasing with an increase in number of regressors in the model. Because increases in the number of regressors increase the value of R, R alone cannot be used as a meaningful comparison of models with very different numbers of independent variables. For a meaningful comparison between two models, an F-test can be performed on the residual sum of squares , similar to the F-tests in Granger causality, though this is not always appropriate. As a reminder of this, some authors denote R by Rq, where q is the number of columns in X (the number of explanators including the constant).

To demonstrate this property, first recall that the objective of least squares linear regression is

where Xi is a row vector of values of explanatory variables for case i and b is a column vector of coefficients of the respective elements of Xi.

The optimal value of the objective is weakly smaller as more explanatory variables are added and hence additional columns of 



X


{\displaystyle X}

 (the explanatory data matrix whose ith row is Xi) are added, by the fact that less constrained minimization leads to an optimal cost which is weakly smaller than more constrained minimization does. Given the previous conclusion and noting that 



S

S

t
o
t




{\displaystyle SS_{tot}}

 depends only on y, the non-decreasing property of R follows directly from the definition above.

The intuitive reason that using an additional explanatory variable cannot lower the R is this: Minimizing 



S

S

res




{\displaystyle SS_{\text{res}}}

 is equivalent to maximizing R. When the extra variable is included, the data always have the option of giving it an estimated coefficient of zero, leaving the predicted values and the R unchanged. The only way that the optimization problem will give a non-zero coefficient is if doing so improves the R.

The above gives an analytical explanation of the inflation of R. Next, an example based on ordinary least square from a geometric perspective is shown below.

A simple case to be considered first:

This equation describes the ordinary least squares regression model with one regressor. The prediction is shown as the red vector in the figure on the right. Geometrically, it is the projection of true value onto a model space in 




R



{\displaystyle \mathbb {R} }

 (without intercept). The residual is shown as the red line.

This equation corresponds to the ordinary least squares regression model with two regressors. The prediction is shown as the blue vector in the figure on the right. Geometrically, it is the projection of true value onto a larger model space in 





R


2




{\displaystyle \mathbb {R} ^{2}}

 (without intercept). Noticeably, the values of 




β

0




{\displaystyle \beta _{0}}

 and 




β

0




{\displaystyle \beta _{0}}

 are not the same as in the equation for smaller model space as long as 




X

1




{\displaystyle X_{1}}

 and 




X

2




{\displaystyle X_{2}}

 are not zero vectors. Therefore, the equations are expected to yield different predictions (i.e., the blue vector is expected to be different from the 